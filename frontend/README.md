# Sage Review Tool

A 3-panel review UI for synthetic Q&A pairs generated by the data generation pipeline. Review items, accept/reject, add notes, override citations, and upload accepted items to LangSmith.

## Prerequisites

- Node.js 18+
- Python 3.10+
- pnpm
- Project dependencies: `uv pip install -e ".[frontend]"`

## Quick Start

```bash
cd frontend
pnpm install
./run-dev.sh
```

This starts both the FastAPI backend (`:8000`) and the Next.js frontend (`:3000`).

Open [http://localhost:3000](http://localhost:3000) to start reviewing.

## Architecture

```
frontend/
├── api/                  # Python FastAPI backend
│   ├── main.py           # Endpoints: items, kb, citation, upload
│   ├── config.py         # Path resolution
│   ├── models.py         # Pydantic models
│   └── services/         # review_store, kb_store, citation, upload
│
├── src/
│   ├── app/              # Next.js App Router (layout, page, globals)
│   ├── components/       # React components (10 total)
│   ├── lib/              # API client, TypeScript types
│   └── stores/           # Zustand state management
│
└── run-dev.sh            # Start both servers
```

## Keyboard Shortcuts

| Key | Action |
|-----|--------|
| `j` / `↓` | Next item |
| `k` / `↑` | Previous item |
| `a` | Accept current |
| `r` | Reject current |
| `n` | Focus reviewer notes |
| `/` | Focus search |
| `Escape` | Blur input |

## Data Flow

1. On first load, the backend copies `output.jsonl` into `review.jsonl` with review fields (`accepted`, `reviewer_notes`, `citation_overridden`).
2. All edits auto-save to `review.jsonl` via PATCH.
3. Upload sends only `accepted: true` items to LangSmith.
